<?xml version="1.0" encoding="UTF-8"?>
<section xml:id="s-closure-operations-on-relations"><title>Closure Operations on Relations</title>
<p>In Section 6.1, we studied relations and one important operation on relations, namely composition. This operation enables us to generate new relations from previously known relations. In Section 6.3, we discussed some key properties of relations. We now wish to consider the situation of constructing a new relation \(r^+\) from an existing relation <m>r</m> where, first, \(r^+\) contains <m>r</m> and, second, \(r^{+ }\) satisfies the transitive property.</p>



<p>Consider a telephone network in which the main office <m>a</m> is connected to, and can communicate to, individuals <m>b</m> and <m>c</m>.  Both <m>b</m> and <m>c</m> can communicate to another person, <m>d</m>; however, the main office cannot communicate with <m>d</m>. Assume communication is only one way, as indicated. This situation can be described by the relation \(r = \{(a, b), (a, c), (b, d), (c, d)\}\). We would like to change the system so that the main office <m>a</m> can communicate with person <m>d</m> and still maintain the previous system. We, of course, want the most economical system.</p>

<p>This can be rephrased as follows; Find the smallest relation \(r^{+ }\)which contains <m>r</m> as a subset and which is transitive; \(r^+ =\{(a, b), (a, c), (b, d), (c, d), (a, d)\}\).</p>

<definition xml:id="def-transitive-closure"><title>Transitive Closure</title><index><main>title>Transitive Closure</main></index><statement><p>Let <m>A</m> be a set and <m>r</m> be a relation on <m>A</m>. The transitive closure of <m>r</m>, denoted by \(r^+\) , is the smallest transitive relation that contains <m>r</m> as a subset.</p></statement><notation><usage>r^+</usage><description>The transitive closure of <m>r</m></description></notation></definition> 

<p>Let \(A = \{1, 2, 3, 4$\}\), and let \(\mathcal{S} = \{(1, 2), (2, 3), (3, 4)\}\) be a relation on <m>A</m>. This relation is called the successor relation on <m>A</m> since each element is related to its successor. How do we compute \(\mathcal{S}^+\)?  By inspection we note that \((1, 3)\) must be in \(\mathcal{S}^+\) . Let's analyze why. This is so because \((1,2) \in \mathcal{S}\) and \((2, 3) \in \mathcal{S}\), and the transitive property forces \((1,3)\) to be in \(\mathcal{S}^+\). </p>

<p>In general, it follows that if \((a, b) \in \mathcal{S}\) and \((b, c) \in S,\) then \((a, c) \in \mathcal{S}^+ \). This condition is exactly the membership requirement for the pair \((a, c)\) to be in the composition \(\mathcal{S}\mathcal{S} = \mathcal{S}^2\). So every element in \(\mathcal{S}^2\) must be an element in \(\mathcal{S}^+\) . So we now know that, \(\mathcal{S}^+\) contains at least \(\mathcal{S} \cup  \mathcal{S}^2\) . In particular, for this example, since \(\mathcal{S} = \{(1, 2), (2, 3), (3, 4)\}\) and \(\mathcal{S}^2 = \{(1, 3), (2, 4)\}\), we have 

\[\mathcal{S} \cup  \mathcal{S}^2 =\{(1, 2), (2, 3), (3, 4), (1, 3), (2, 4)\}\]
</p>

<p>Is the relation \(\mathcal{S} \cup  \mathcal{S}^2\) transitive? Again, by inspection, \((1, 4)\) is not an element of \(\mathcal{S} \cup  \mathcal{S}^2\), but  \((1,3) \in \mathcal{S}^2\) and \((3, 4) \in \mathcal{S}\). Therefore, the composition \(\mathcal{S}^2 \mathcal{S} = \mathcal{S}^3\) produces \((1, 4)\), and it must be an element of \(\mathcal{S}^+\) since \((1,3)\) and \((3, 4)\) are required to be in \(\mathcal{S}^+\).  This shows that \(\mathcal{S}^3 \subseteq  \mathcal{S} ^+\) . This process must be continued until the resulting relation is transitive. If A is finite, as is true in this example, the transitive closure will be obtained in a finite number of steps. For this example, 

 \[\mathcal{S}^+ =\mathcal{S}\cup \mathcal{S} ^2\cup  \mathcal{S} ^3=\{(1, 2), (2, 3), (3, 4),(1, 3),(2, 4),(1,4)\}\]
 </p>

<theorem xml:id="theorem-transitive-closure-formula"><title>Transitive Closure on a Finite Set</title><statement><p>If <m>r</m> is a relation on a set <m>A</m> and \(|A| = n\), then the transitive closure of <m>r</m> is the union of the first <m>n</m> powers of
r.  That is, 
\[r^+ = r \cup  r^2 \cup  r ^3 \cup \cdots  \cup  \text{\textit{$r$}}^n\].</p></statement></theorem> 



<p>Let's now consider the matrix analogue of the transitive closure.</p>

<p>Consider the relation 

\(r = \{(1, 4), (2, 1), (2, 2), (2, 3),(3, 2), (4, 3), (4, 5), (5, 1)\}\) 

on the set \(A = \{1,2, 3, 4, 5\}\). The matrix of <m>r</m> is



 \(R=\left(
\begin{array}{ccccc}
 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\
 1 &amp; 1 &amp; 1 &amp; 0 &amp; 0 \\
 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
 0 &amp; 0 &amp; 1 &amp; 0 &amp; 1 \\
 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
\end{array}
\right)\)</p>

<p>Recall that \(r^2, r^3, \ldots\)  can be determined through computing the matrix powers \(R^2, R^3, \ldots\).  For our example,</p>
<table>
<tabulate>
<row><cell>
 \(R^2=\left(
\begin{array}{ccccc}
 0 &amp; 0 &amp; 1 &amp; 0 &amp; 1 \\
 1 &amp; 1 &amp; 1 &amp; 1 &amp; 0 \\
 1 &amp; 1 &amp; 1 &amp; 0 &amp; 0 \\
 1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\
\end{array}
\right)\) </cell>
<cell> \(R^3=\left(
\begin{array}{ccccc}
 1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 \\
 1 &amp; 1 &amp; 1 &amp; 1 &amp; 0 \\
 1 &amp; 1 &amp; 1 &amp; 1 &amp; 0 \\
 0 &amp; 0 &amp; 1 &amp; 0 &amp; 1 \\
\end{array}
\right)\)</cell></row>


<row><cell>
 \(R^4=\left(
\begin{array}{ccccc}
 1 &amp; 1 &amp; 1 &amp; 1 &amp; 0 \\
 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 \\
 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 \\
 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 \\
 1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
\end{array}
\right)\)</cell>
<cell>\(R^5=\left(
\begin{array}{ccccc}
 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 \\
 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 \\
 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 \\
 1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 \\
 1 &amp; 1 &amp; 1 &amp; 1 &amp; 0 \\
\end{array}
\right)\)</cell></row>
</tabulate>
</table>

<p>How do we relate \(\underset{i=1}{\overset{5}{\cup }}r^i\) to the powers of <m>R</m>?</p>

<theorem xml:id="theorem-matrix-transitive-closure"><title>Matrix of a Transitive Closure</title><statement><p>Let <m>r</m> be a relation on a finite set and let \(R^+\) be the matrix of \(r^+\) , the transitive closure of <m>r</m>.  Then \(R^+
= R + R^2 + \cdots + R^n\), using Boolean arithmetic.</p></statement></theorem>



<p>Using this theorem, we find \(R^+\) is the \(5\times 5\) matrix consisting of all \(1's\), thus, \(r^+\) is all of \(A \times A\).</p>


<subsection xml:id="ss-warshall-algorithm"><title>Warshall's Algorithm</title>
<p>Let <m>r</m> be a relation on the set \(\{1, 2, \dots , n\}\) with relation matrix <m>R</m>. The matrix of the transitive closure \(R^+\), can be computed by the equation \(R^+ = R + R ^2 + \cdots  + R^n\). By using ordinary polynomial evaluation methods, you can compute \(R^+\) with \(n -1\) matrix multiplications: 
\[R^+ = R(I + R(I +( \cdots  R(I+ R) \cdots )))\]</p>

<p>For example, if \(n = 3\), \(R = R(I + R(I + R))\).</p>

We can make use of the fact that if <m>T</m> is a relation matrix, \(T + T = T\) due to the fact that \(1 + 1 = 1\) in Boolean arithmetic. Let \(S_k = R + R^2 + \cdots  + R^k\) . Then

\(R = S_1\)



\(S_1\text{ (}\text{\textit{$I$}}\text{ + }S_1\text{) = }\text{\textit{$R$}}\text{ (}\text{\textit{$I$}}\text{ + }\text{\textit{$R$}}\text{)
= }\text{\textit{$R$}}\text{ + }R^2\text{ = }S_2\)



\(S_2 \left(I + S _2\right) = \left(R + R^2 \right)\left(I + R + R^2 \right)\\
\\
=\left(R + R ^2\right) + \left(R^2 + R ^3 \right) + \left(R^3+ R^4 \right) \\
\\
= R + R^2 + R ^3 + R ^4 =S_4\)



Similarly, 



\(S_4\left(I+S_4\right) = S_8\)



etc..



Notice how each matrix multiplication doubles the number of terms that have been added to the sum that you currently have computed. In algorithmic
form, we can compute \(R^2\) as follows.



\pmb{ Algorithm 6.5.1: Transitive Closure Algorithm 1.} Let <m>R</m> be a known relation matrix and let \(R^+\) be its transitive closure matrix, which
is to be computed.

<program>
<input>
1.0. \(T\text{:=}R\) 



2.0. Repeat



2.1 \(S\text{:=} T\)



2.2 \(T\text{:=} S(I + S)\) // using Boolean arithmetic



    Until \(T = S\)



3.0. Terminate with \(T=R^+\).
</input>
</program>


<p>Notes:</p>
<ol type="a">
<li> Often the higher-powered terms in \(S_n\) do not contribute anything to \(R^+\). When the condition \(T = S\) becomes true in Step 2, this
is an indication that no higher-powered terms are needed.</li>
<li> To compute \(R^+\) using this algorithm, you need to perform no more than \(\left\lceil \log _2 n\right\rceil\) matrix multiplications, where
$\lceil $x$\rceil $ is the least integer that is greater than or equal to <m>x</m>. For example, if <m>r</m> is a relation on 25 elements,
no more than \(\left\lceil \log _2 25\right\rceil =5\) matrix multiplications are needed.</li>
</ol>


A second algorithm, Warshall's Algorithm, reduces computation time to the time that it takes to perform one matrix multiplication.



\pmb{ Algorithm 6.5.2; Warshall's Algorithm.} Let <m>R</m> be a known relation matrix and let \(R^+\) be its transitive closure matrix, which
is to be computed.

<program>
<input>

1.0 \(T\text{:=} R\)



2.0  FOR \(k: = 1 \text{to} n\) DO



         FOR \(i: = 1 \text{to} n\) DO



            FOR \(j \text{:=} 1 \text{to} n\)   DO



               \(T[i,j]\text{:=}T[i,j] + T[i,k]\cdot T[k,j]\)



3.0 Terminate with \(T=R^+\).

</input>
</program>

</subsection>
<exercises xml:id="exercises-6-5><title>Exercises</title>


<exercisegroup><introduction>A Exercises</introduction>

</statement></exercise>
<exercise number="1"><statement> Let <m>A</m> and $\mathcal{S}$ be as in Example 6.5.1. Compute \(\mathcal{S}^+\) as in Example 6.5.2. Verify your results by checking against
the relation \(\mathcal{S}^+\) obtained in Example 6.5.1.

</statement></exercise>
<exercise number="2"><statement> Let <m>A</m> and <m>r</m> be as in Example 6.5.2. Compute the relation \(r^+\) as in Example 6.5.1. Verify your results.

</statement></exercise>
<exercise number="3"><statement> (a) Draw digraphs of the relations \(\mathcal{S}\), \(\mathcal{S}^2\), \(\mathcal{S}^3\) , and \(\mathcal{S}^+\) of Example 6.5.1.</li>
<li> Verify that in terms of the graph of \(\mathcal{S}\), \(a \mathcal{S}^+ b\) if and only if <m>b</m> is reachable from <m>a</m> along a
path of any finite nonzero length.

</statement></exercise>
<exercise number="4"><statement> Let <m>r</m> be the relation represented by the digraph in Figure 6.5,1.
<ol type="a">
<li> Find \(r^+\)</li>
<li> Determine the digraph of \(r^+\) directly from the digraph of <m>r</m>.</li>
<li> Verify your result in part (b) by computing the digraph from your result in part (a).


\begin{center}\(\)
\end{center}


\caption{\pmb{ FIGURE 6.5.1}}

</statement></exercise>
<exercise number="5"><statement> (a) Define reflexive closure and symmetric closure by imitating the definition of transitive closure.



  (b) Use your definitions to compute the reflexive and symmetric closures of Examples 6.5.1 and 6.5.2.



  (c) What are the transitive reflexive closures of these examples?



  (d) Convince yourself that the reflexive closure of the relation $<$ on the set of positive integers $\mathbb{P}$ is $\leq $.

</statement></exercise>
<exercise number="6"><statement> What common relations on $\mathbb{Z}$ are the transitive closures of the following relations?
<ol type="a">
<li> \(a S b\) if and only if \(a + 1 = b\).</li>
<li> \(a R b\) if and only if \(| a - b | = 2\).

</exercisegroup>

\subsubsection{B Exercise}

</statement></exercise>
<exercise number="7"><statement> (a) Let <m>A</m> be any set and <m>r</m> a relation on <m>A</m>, prove that \(\left(r^+\right)^+=r^+\).



   (b) Is the transitive closure of a symmetric relation always both symmetric and reflexive? Explain.
   
</exercisegroup>
</exercises>
</section>