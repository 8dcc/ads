<!DOCTYPE html>
<!--**************************************-->
<!--*    Generated from PreTeXt source   *-->
<!--*    on 2019-05-14T09:24:23-04:00    *-->
<!--*                                    *-->
<!--*      https://pretextbook.org       *-->
<!--*                                    *-->
<!--**************************************-->
<html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>ADS Some Common Recurrence Relations</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width,  initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
<script src="https://sagecell.sagemath.org/embedded_sagecell.js"></script><script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['\\(','\\)']]
    },
    asciimath2jax: {
        ignoreClass: ".*",
        processClass: "has_am"
    },
    jax: ["input/AsciiMath"],
    extensions: ["asciimath2jax.js"],
    TeX: {
        extensions: ["extpfeil.js", "autobold.js", "https://pretextbook.org/js/lib/mathjaxknowl.js", ],
        // scrolling to fragment identifiers is controlled by other Javascript
        positionToHash: false,
        equationNumbers: { autoNumber: "none", useLabelIds: true, },
        TagSide: "right",
        TagIndent: ".8em",
    },
    // HTML-CSS output Jax to be dropped for MathJax 3.0
    "HTML-CSS": {
        scale: 88,
        mtextFontInherit: true,
    },
    CommonHTML: {
        scale: 88,
        mtextFontInherit: true,
    },
});
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML-full"></script><script>$(function () {
    // Make *any* div with class 'sagecell-sage' an executable Sage cell
    // Their results will be linked, only within language type
    sagecell.makeSagecell({inputLocation: 'div.sagecell-sage',
                           linked: true,
                           languages: ['sage'],
                           evalButtonText: 'Evaluate (Sage)'});
});
</script><script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script><script src="https://pretextbook.org/js/lib/jquery.min.js"></script><script src="https://pretextbook.org/js/lib/jquery.sticky.js"></script><script src="https://pretextbook.org/js/lib/jquery.espy.min.js"></script><script src="https://pretextbook.org/js/0.11/pretext.js"></script><script src="https://pretextbook.org/js/0.11/pretext_add_on.js"></script><script src="https://pretextbook.org/js/lib/knowl.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Inconsolata:400,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/pretext.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/pretext_add_on.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/toc.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/colors_default.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/setcolors.css" rel="stylesheet" type="text/css">
<link href="https://pretextbook.org/css/0.2/features.css" rel="stylesheet" type="text/css">
<script>var logged_in = false;
var role = 'student';
var guest_access = true;
var login_required = false;
var js_version = 0.11;
</script>
</head>
<body class="mathbook-book has-toc has-sidebar-left">
<a class="assistive" href="#content">Skip to main content</a><div class="hidden-content" style="display:none">\(\newcommand{\identity}{\mathrm{id}}
\newcommand{\notdivide}{{\not{\mid}}}
\newcommand{\notsubset}{\not\subset}
\newcommand{\lcm}{\operatorname{lcm}}
\newcommand{\gf}{\operatorname{GF}}
\newcommand{\inn}{\operatorname{Inn}}
\newcommand{\aut}{\operatorname{Aut}}
\newcommand{\Hom}{\operatorname{Hom}}
\newcommand{\cis}{\operatorname{cis}}
\newcommand{\chr}{\operatorname{char}}
\newcommand{\Null}{\operatorname{Null}}
\renewcommand{\vec}[1]{\mathbf{#1}}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\)</div>
<header id="masthead" class="smallbuttons"><div class="banner"><div class="container">
<a id="logo-link" href="http://discretemath.org" target="_blank"><img src="http://discretemath.org/images/ads_v3_cover.jpg" alt="Logo image"></a><div class="title-container">
<h1 class="heading"><a href="ads.html"><span class="title">Applied Discrete Structures</span></a></h1>
<p class="byline">Al Doerr, Ken Levasseur</p>
</div>
</div></div>
<nav id="primary-navbar" class="navbar"><div class="container">
<div class="navbar-top-buttons">
<button class="sidebar-left-toggle-button button active" aria-label="Show or hide table of contents sidebar">Contents</button><div class="tree-nav toolbar toolbar-divisor-3">
<a class="index-button toolbar-item button" href="index-1.html" title="Index">Index</a><span class="threebuttons"><a id="previousbutton" class="previous-button toolbar-item button" href="s-recurrence-relations.html" title="Previous">Prev</a><a id="upbutton" class="up-button button toolbar-item" href="chapter_8.html" title="Up">Up</a><a id="nextbutton" class="next-button button toolbar-item" href="s-generating-functions.html" title="Next">Next</a></span>
</div>
</div>
<div class="navbar-bottom-buttons toolbar toolbar-divisor-4">
<button class="sidebar-left-toggle-button button toolbar-item active">Contents</button><a class="previous-button toolbar-item button" href="s-recurrence-relations.html" title="Previous">Prev</a><a class="up-button button toolbar-item" href="chapter_8.html" title="Up">Up</a><a class="next-button button toolbar-item" href="s-generating-functions.html" title="Next">Next</a>
</div>
</div></nav></header><div class="page">
<div id="sidebar-left" class="sidebar" role="navigation"><div class="sidebar-content">
<nav id="toc"><ul>
<li class="link">
<a href="index.html" data-scroll="index"><span class="title">Front Matter</span></a><ul>
<li><a href="colophon-1.html" data-scroll="colophon-1">Colophon</a></li>
<li><a href="dedication-1.html" data-scroll="dedication-1">Dedication</a></li>
<li><a href="acknowledgement-1.html" data-scroll="acknowledgement-1">Acknowledgements</a></li>
<li><a href="ads-preface.html" data-scroll="ads-preface">Preface</a></li>
</ul>
</li>
<li class="link">
<a href="chapter_1.html" data-scroll="chapter_1"><span class="codenumber">1</span> <span class="title">Set Theory</span></a><ul>
<li><a href="s-set-Notation-and-Relations.html" data-scroll="s-set-Notation-and-Relations">Set Notation and Relations</a></li>
<li><a href="s-basic_Set_Operations.html" data-scroll="s-basic_Set_Operations">Basic Set Operations</a></li>
<li><a href="s-cartesian_Products_and_Power_Sets.html" data-scroll="s-cartesian_Products_and_Power_Sets">Cartesian Products and Power Sets</a></li>
<li><a href="s-binary_Representation_of_Positive_Integers.html" data-scroll="s-binary_Representation_of_Positive_Integers">Binary Representation of Positive Integers</a></li>
<li><a href="s-summation_Notation_and_Generalizations.html" data-scroll="s-summation_Notation_and_Generalizations">Summation Notation and Generalizations</a></li>
</ul>
</li>
<li class="link">
<a href="chapter_2.html" data-scroll="chapter_2"><span class="codenumber">2</span> <span class="title">Combinatorics</span></a><ul>
<li><a href="s-the-rule-of-products.html" data-scroll="s-the-rule-of-products">Basic Counting Techniques - The Rule of Products</a></li>
<li><a href="s-permutations.html" data-scroll="s-permutations">Permutations</a></li>
<li><a href="s-partitions-and-law-of-addition.html" data-scroll="s-partitions-and-law-of-addition">Partitions of Sets and the Law of Addition</a></li>
<li><a href="s-combinations-and-the-binomial-theorem.html" data-scroll="s-combinations-and-the-binomial-theorem">Combinations and the Binomial Theorem</a></li>
</ul>
</li>
<li class="link">
<a href="chapter3.html" data-scroll="chapter3"><span class="codenumber">3</span> <span class="title">Logic</span></a><ul>
<li><a href="s-propositions-logic-operators.html" data-scroll="s-propositions-logic-operators">Propositions and Logical Operators</a></li>
<li><a href="s-truth-tables.html" data-scroll="s-truth-tables">Truth Tables and Propositions Generated by a Set</a></li>
<li><a href="s-equivalence-implication.html" data-scroll="s-equivalence-implication">Equivalence and Implication</a></li>
<li><a href="s-logic-laws.html" data-scroll="s-logic-laws">The Laws of Logic</a></li>
<li><a href="s-math-systems.html" data-scroll="s-math-systems">Mathematical Systems and Proofs</a></li>
<li><a href="s-propositions-over-universe.html" data-scroll="s-propositions-over-universe">Propositions over a Universe</a></li>
<li><a href="s-induction.html" data-scroll="s-induction">Mathematical Induction</a></li>
<li><a href="s-quantifiers.html" data-scroll="s-quantifiers">Quantifiers</a></li>
<li><a href="s-proof-review.html" data-scroll="s-proof-review">A Review of Methods of Proof</a></li>
</ul>
</li>
<li class="link">
<a href="chapter_4.html" data-scroll="chapter_4"><span class="codenumber">4</span> <span class="title">More on Sets</span></a><ul>
<li><a href="s-proof-methods-sets.html" data-scroll="s-proof-methods-sets">Methods of Proof for Sets</a></li>
<li><a href="s-laws-of-set-theory.html" data-scroll="s-laws-of-set-theory">Laws of Set Theory</a></li>
<li><a href="s-minsets.html" data-scroll="s-minsets">Minsets</a></li>
<li><a href="s-duality-principle.html" data-scroll="s-duality-principle">The Duality Principle</a></li>
</ul>
</li>
<li class="link">
<a href="chapter_5.html" data-scroll="chapter_5"><span class="codenumber">5</span> <span class="title">Introduction to Matrix Algebra</span></a><ul>
<li><a href="s-basic-matrix-definitions.html" data-scroll="s-basic-matrix-definitions">Basic Definitions and Operations</a></li>
<li><a href="s-special-matrices.html" data-scroll="s-special-matrices">Special Types of Matrices</a></li>
<li><a href="s-laws-of-matrix-algebra.html" data-scroll="s-laws-of-matrix-algebra">Laws of Matrix Algebra</a></li>
<li><a href="s-matrix-oddities.html" data-scroll="s-matrix-oddities">Matrix Oddities</a></li>
</ul>
</li>
<li class="link">
<a href="chapter_6.html" data-scroll="chapter_6"><span class="codenumber">6</span> <span class="title">Relations</span></a><ul>
<li><a href="s-basic-definitions.html" data-scroll="s-basic-definitions">Basic Definitions</a></li>
<li><a href="s-graphs-of-relations-on-a-set.html" data-scroll="s-graphs-of-relations-on-a-set">Graphs of Relations on a Set</a></li>
<li><a href="s-properties-of-relations.html" data-scroll="s-properties-of-relations">Properties of Relations</a></li>
<li><a href="s-matrices-of-relations.html" data-scroll="s-matrices-of-relations">Matrices of Relations</a></li>
<li><a href="s-closure-operations-on-relations.html" data-scroll="s-closure-operations-on-relations">Closure Operations on Relations</a></li>
</ul>
</li>
<li class="link">
<a href="chapter_7.html" data-scroll="chapter_7"><span class="codenumber">7</span> <span class="title">Functions</span></a><ul>
<li><a href="s-function-def-notation.html" data-scroll="s-function-def-notation">Definition and Notation</a></li>
<li><a href="s-properties-of-functions.html" data-scroll="s-properties-of-functions">Properties of Functions</a></li>
<li><a href="s-function-composition.html" data-scroll="s-function-composition">Function Composition</a></li>
</ul>
</li>
<li class="link">
<a href="chapter_8.html" data-scroll="chapter_8"><span class="codenumber">8</span> <span class="title">Recursion and Recurrence Relations</span></a><ul>
<li><a href="s-faces-of-recursion.html" data-scroll="s-faces-of-recursion">The Many Faces of Recursion</a></li>
<li><a href="s-Sequences.html" data-scroll="s-Sequences">Sequences</a></li>
<li><a href="s-recurrence-relations.html" data-scroll="s-recurrence-relations">Recurrence Relations</a></li>
<li><a href="s-some-common-rrs.html" data-scroll="s-some-common-rrs" class="active">Some Common Recurrence Relations</a></li>
<li><a href="s-generating-functions.html" data-scroll="s-generating-functions">Generating Functions</a></li>
</ul>
</li>
<li class="link">
<a href="chapter_9.html" data-scroll="chapter_9"><span class="codenumber">9</span> <span class="title">Graph Theory</span></a><ul>
<li><a href="s-graphs-introduction.html" data-scroll="s-graphs-introduction">Graphs - General Introduction</a></li>
<li><a href="s-data-structures-for-graphs.html" data-scroll="s-data-structures-for-graphs">Data Structures for Graphs</a></li>
<li><a href="s-Connectivity.html" data-scroll="s-Connectivity">Connectivity</a></li>
<li><a href="s-traversals.html" data-scroll="s-traversals">Traversals: Eulerian and Hamiltonian Graphs</a></li>
<li><a href="s-graph-optimization.html" data-scroll="s-graph-optimization">Graph Optimization</a></li>
<li><a href="s-planarity-and-colorings.html" data-scroll="s-planarity-and-colorings">Planarity and Colorings</a></li>
</ul>
</li>
<li class="link">
<a href="chapter_10.html" data-scroll="chapter_10"><span class="codenumber">10</span> <span class="title">Trees</span></a><ul>
<li><a href="s-what-is-a-tree.html" data-scroll="s-what-is-a-tree">What Is a Tree?</a></li>
<li><a href="s-spanning-trees.html" data-scroll="s-spanning-trees">Spanning Trees</a></li>
<li><a href="s-rooted-trees.html" data-scroll="s-rooted-trees">Rooted Trees</a></li>
<li><a href="s-binary-trees.html" data-scroll="s-binary-trees">Binary Trees</a></li>
</ul>
</li>
<li class="link">
<a href="chapter_11.html" data-scroll="chapter_11"><span class="codenumber">11</span> <span class="title">Algebraic Structures</span></a><ul>
<li><a href="s-Operations.html" data-scroll="s-Operations">Operations</a></li>
<li><a href="s-algebraic-systems.html" data-scroll="s-algebraic-systems">Algebraic Systems</a></li>
<li><a href="s-general-properties-of-groups.html" data-scroll="s-general-properties-of-groups">Some General Properties of Groups</a></li>
<li><a href="s-gcds-and-zsubn.html" data-scroll="s-gcds-and-zsubn">Greatest Common Divisors  and the Integers Modulo \(n\)</a></li>
<li><a href="s-Subsystems.html" data-scroll="s-Subsystems">Subsystems</a></li>
<li><a href="s-direct-products.html" data-scroll="s-direct-products">Direct Products</a></li>
<li><a href="s-isomorphisms.html" data-scroll="s-isomorphisms">Isomorphisms</a></li>
</ul>
</li>
<li class="link">
<a href="chapter_12.html" data-scroll="chapter_12"><span class="codenumber">12</span> <span class="title">More Matrix Algebra</span></a><ul>
<li><a href="s-systems-linear-equations.html" data-scroll="s-systems-linear-equations">Systems of Linear Equations</a></li>
<li><a href="s-matrix-inversion.html" data-scroll="s-matrix-inversion">Matrix Inversion</a></li>
<li><a href="s-intro-to-vector-spaces.html" data-scroll="s-intro-to-vector-spaces">An Introduction to Vector Spaces</a></li>
<li><a href="s-the-diagonalization-process.html" data-scroll="s-the-diagonalization-process">The Diagonalization Process</a></li>
<li><a href="s-some-applications.html" data-scroll="s-some-applications">Some Applications</a></li>
<li><a href="s-systems-linear-equations-mod-2.html" data-scroll="s-systems-linear-equations-mod-2">Linear Equations over the Integers Mod 2</a></li>
</ul>
</li>
<li class="link">
<a href="chapter_13.html" data-scroll="chapter_13"><span class="codenumber">13</span> <span class="title">Boolean Algebra</span></a><ul>
<li><a href="s-posets-revisited.html" data-scroll="s-posets-revisited">Posets Revisited</a></li>
<li><a href="s-lattices.html" data-scroll="s-lattices">Lattices</a></li>
<li><a href="s-boolean-algebras.html" data-scroll="s-boolean-algebras">Boolean Algebras</a></li>
<li><a href="s-atoms-of-a-boolean-algebra.html" data-scroll="s-atoms-of-a-boolean-algebra">Atoms of a Boolean Algebra</a></li>
<li><a href="s-finite-boolean-algebras-ntuples.html" data-scroll="s-finite-boolean-algebras-ntuples">Finite Boolean Algebras as \(n\)-tuples of 0's and 1's</a></li>
<li><a href="s-boolean-expressions.html" data-scroll="s-boolean-expressions">Boolean Expressions</a></li>
</ul>
</li>
<li class="link">
<a href="chapter_14.html" data-scroll="chapter_14"><span class="codenumber">14</span> <span class="title">Monoids and Automata</span></a><ul>
<li><a href="s-Monoids.html" data-scroll="s-Monoids">Monoids</a></li>
<li><a href="s-free-monoids-and-languages.html" data-scroll="s-free-monoids-and-languages">Free Monoids and Languages</a></li>
<li><a href="s-automata-finite-state-machines.html" data-scroll="s-automata-finite-state-machines">Automata, Finite-State Machines</a></li>
<li><a href="s-monoid-of-fsm.html" data-scroll="s-monoid-of-fsm">The Monoid of a Finite-State Machine</a></li>
<li><a href="s-machine-of-monoid.html" data-scroll="s-machine-of-monoid">The Machine of a Monoid</a></li>
</ul>
</li>
<li class="link">
<a href="chapter_15.html" data-scroll="chapter_15"><span class="codenumber">15</span> <span class="title">Group Theory and Applications</span></a><ul>
<li><a href="s-cyclic-groups.html" data-scroll="s-cyclic-groups">Cyclic Groups</a></li>
<li><a href="s-cosets-and-factor-groups.html" data-scroll="s-cosets-and-factor-groups">Cosets and Factor Groups</a></li>
<li><a href="s-permutation-groups.html" data-scroll="s-permutation-groups">Permutation Groups</a></li>
<li><a href="s-normal-subgroups-homomorphisms.html" data-scroll="s-normal-subgroups-homomorphisms">Normal Subgroups and Group Homomorphisms</a></li>
<li><a href="s-coding-theory-groups.html" data-scroll="s-coding-theory-groups">Coding Theory, Group Codes</a></li>
</ul>
</li>
<li class="link">
<a href="chapter_16.html" data-scroll="chapter_16"><span class="codenumber">16</span> <span class="title">An Introduction to Rings and Fields</span></a><ul>
<li><a href="s-rings-basic.html" data-scroll="s-rings-basic">Rings, Basic Definitions and Concepts</a></li>
<li><a href="s-fields.html" data-scroll="s-fields">Fields</a></li>
<li><a href="s-polynomial-rings.html" data-scroll="s-polynomial-rings">Polynomial Rings</a></li>
<li><a href="s-field-extensions.html" data-scroll="s-field-extensions">Field Extensions</a></li>
<li><a href="s-power-series.html" data-scroll="s-power-series">Power Series</a></li>
</ul>
</li>
<li class="link"><a href="backmatter.html" data-scroll="backmatter"><span class="title">Back Matter</span></a></li>
<li class="link">
<a href="app-algorithms.html" data-scroll="app-algorithms"><span class="codenumber">A</span> <span class="title">Algorithms</span></a><ul>
<li><a href="app-alg1.html" data-scroll="app-alg1">An Introduction to Algorithms</a></li>
<li><a href="app-alg2.html" data-scroll="app-alg2">The Invariant Relation Theorem</a></li>
</ul>
</li>
<li class="link">
<a href="app-pythonsage.html" data-scroll="app-pythonsage"><span class="codenumber">B</span> <span class="title">Python and SageMath</span></a><ul>
<li><a href="app-python-iterators.html" data-scroll="app-python-iterators">Python Iterators</a></li>
<li><a href="app-pythonsage-dictionaries.html" data-scroll="app-pythonsage-dictionaries">Dictionaries</a></li>
</ul>
</li>
<li class="link">
<a href="app-determinants.html" data-scroll="app-determinants"><span class="codenumber">C</span> <span class="title">Determinants</span></a><ul>
<li><a href="section-88.html" data-scroll="section-88">Definition</a></li>
<li><a href="section-89.html" data-scroll="section-89">Computation</a></li>
</ul>
</li>
<li class="link"><a href="solutions-backmatter.html" data-scroll="solutions-backmatter"><span class="codenumber">D</span> <span class="title">Hints and Solutions to Selected Exercises</span></a></li>
<li class="link"><a href="appendix-4.html" data-scroll="appendix-4"><span class="codenumber">E</span> <span class="title">Notation</span></a></li>
<li class="link"><a href="references-2.html" data-scroll="references-2"><span class="title">References</span></a></li>
<li class="link"><a href="index-1.html" data-scroll="index-1"><span class="title">Index</span></a></li>
</ul></nav><div class="extras"><nav><a class="mathbook-link" href="https://pretextbook.org">Authored in PreTeXt</a><a href="https://www.mathjax.org"><img title="Powered by MathJax" src="https://www.mathjax.org/badge/badge.gif" alt="Powered by MathJax"></a></nav></div>
</div></div>
<main class="main"><div id="content" class="pretext-content"><section class="section" id="s-some-common-rrs"><h2 class="heading hide-type">
<span class="type">Section</span> <span class="codenumber">8.4</span> <span class="title">Some Common Recurrence Relations</span>
</h2>
<a href="s-some-common-rrs.html" class="permalink">¶</a><section class="introduction" id="introduction-22"><p id="p-2753">In this section we intend to examine a variety of recurrence relations that are not finite-order linear with constant coefficients. For each part of this section, we will consider a concrete example, present a solution, and, if possible, examine a more general form of the original relation.</p></section><section class="subsection" id="rr-basic-example"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">8.4.1</span> <span class="title">A  First Basic Example</span>
</h3>
<a href="s-some-common-rrs.html#rr-basic-example" class="permalink">¶</a><p id="p-2754">Consider the homogeneous first-order linear relation without constant coefficients,  \(S(n) - n S(n - 1) = 0\text{,}\) \(n \geq  1\text{,}\) with initial condition \(S(0)
= 1\text{.}\) Upon close examination of this relation, we see that the \(n\)th term is \(n\) times the \((n - 1)^{st}\) term, which is a property of \(n\) factorial. \(S(n) = n!\) is a solution of this relation, for if \(n \geq  1\text{,}\)</p>
<div class="displaymath">
\begin{equation*}
S(n) = n! = n \cdot (n -1)! = n\cdot  S(n - 1)
\end{equation*}
</div>
<p>In addition, since \(0! = 1\text{,}\) the initial condition is satisfied. It should be pointed out that from a computational point of view, our “solution” really isn't much of an improvement since the exact calculation of \(n!\) takes \(n-1\) multiplications.</p>
<p id="p-2755">If we examine a similar relation, \(G(k) - 2 ^k G(k - 1),\) \(k\geq 1\) with \(G(0) = 1\text{,}\) a table of values for \(G\) suggests a possible solution:</p>
<div class="displaymath">
\begin{equation*}
\begin{array}{ccccccc}
k &amp; 0 &amp; 1 &amp; 2 &amp; 3 &amp; 4 &amp; 5 \\
\hline
G(k) &amp; 1 &amp; 2 &amp; 2^3 &amp; 2^6 &amp; 2^{10} &amp; 2^{15} \\
\end{array}
\end{equation*}
</div>
<p>The exponent of 2 in \(G(k)\) is growing according to the relation \(E(k) = E(k - 1) + k,\) with \(E(0) = 0\text{.}\) Thus \(E(k)=\frac{k(k+1)}{2}\) and \(G(k) = 2^{k(k+1)/2}\text{.}\) Note that \(G(k)\) could also be written as \(2^0 2^1 2^2 \cdots 2^k\text{,}\) for \(k \geq  0\text{,}\) but this is not a closed form expression.</p>
<p id="p-2756">In general, the relation \(P(n) = f(n)P(n - 1)\) for \(n \geq 1\) with \(P(0) =f(0)\text{,}\) where \(f\) is a function that is defined for all \(n\geq
0\text{,}\) has the “solution”</p>
<div class="displaymath">
\begin{equation*}
P(n)=\prod _{k=0}^n f(k)
\end{equation*}
</div>
<p>This product form of \(P(n)\) is not a closed form expression because as \(n\) grows, the number of multiplications grow. Thus, it is really not a true solution.  Often, as for \(G(k)\) above, a closed form expression can be derived from the product form.</p></section><section class="subsection" id="analysis-of-binary-search"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">8.4.2</span> <span class="title">An Analysis of the Binary Search Algorithm</span>
</h3>
<a href="s-some-common-rrs.html#analysis-of-binary-search" class="permalink">¶</a><section class="subsubsection" id="subsubsection-1"><h4 class="heading hide-type">
<span class="type">Subsubsection</span> <span class="codenumber">8.4.2.1</span> <span class="title"></span>
</h4>
<p id="p-2757">Suppose you intend to use a binary search algorithm (see <a href="s-faces-of-recursion.html#ss-recursive-searching" class="internal" title="Subsection 8.1.3: Recursive Searching - The Binary Search">Subsection 8.1.3</a>) on lists of zero or more sorted items, and that the items are stored in an array, so that you have easy access to each item. A natural question to ask is “How much time will it take to complete the search?” When a question like this is asked, the time we refer to is often the so-called worst-case time. That is, if we were to search through \(n\) items, what is the longest amount of time that we will need to complete the search? In order to make an analysis such as this independent of the computer to be used, time is measured by counting the number of steps that are executed. Each step (or sequence of steps) is assigned an absolute time, or weight; therefore, our answer will not be in seconds, but in absolute time units. If the steps in two different algorithms are assigned weights that are consistent, then analyses of the algorithms can be used to compare their relative efficiencies. There are two major steps that must be executed in a call of the binary search algorithm:</p>
<ol id="p-2758" class="decimal">
<li id="li-1363"><p id="p-2759">If the lower index is less than or equal to the upper index, then the middle of the list is located and its key is compared to the value that you are searching for.</p></li>
<li id="li-1364">
<p id="p-2760">In the worst case, the algorithm must be executed with a list that is roughly half as large as in the previous execution. If we assume that Step 1 takes one time unit and \(T(n)\) is the worst-case time for a list of \(n\) items, then</p>
<div class="displaymath">
\begin{gather}
T(n)= 1 + T (\lfloor n/2 \rfloor ),  \quad n&gt;0\label{eq-bin-search-recursion}\tag{8.4.1}
\end{gather}
</div>
<p>For simplicity, we will assume that</p>
<div class="displaymath">
\begin{gather}
T(0) = 0\label{eq-bin-search-basis}\tag{8.4.2}
\end{gather}
</div>
<p>even though the conditions of Step 1 must be evaluated as false if \(n = 0\text{.}\) You might wonder why \(n/2\) is truncated in <a data-knowl="./knowl/eq-bin-search-recursion.html" title="Equation 8.4.1">(8.4.1)</a>. If \(n\) is odd, then \(n = 2 k + 1\) for some \(k\geq  0\text{,}\) the middle of the list will be the \((k + 1)^{st}\)  item, and no matter what half of the list the search is directed to, the reduced list will have \(k = \lfloor n/2\rfloor\) items. On the other hand, if \(n\) is even, then \(n
= 2 k\) for \(k&gt;0\text{.}\) The middle of the list will be the \(k^{th}\) item, and the worst case will occur if we are directed to the \(k\) items that come after the middle (the \((k + 1)^{st}\) through \((2k)^{th}\) items). Again the reduced list has \(\lfloor n/2 \rfloor\) items.</p>
</li>
</ol>
<p id="p-2761"><em class="emphasis">Solution to <a data-knowl="./knowl/eq-bin-search-recursion.html" title="Equation 8.4.1">(8.4.1)</a>  and <a data-knowl="./knowl/eq-bin-search-basis.html" title="Equation 8.4.2">(8.4.2)</a>.</em>  To determine \(T(n)\text{,}\) the easiest case is when \(n\) is a power of two. If we compute \(T \left(2^m\right)\text{,}\) \(m\geq 0\) , by iteration, our results are</p>
<div class="displaymath">
\begin{equation*}
\begin{array}{c}
T(1) = 1 + T(0) = 1\\
T(2) = 1 + T(1) = 2\\
T(4) = 1 + T(2) = 3\\
T(8) = 1 + T(4) = 4\\
\end{array}
\end{equation*}
</div>
<p>The pattern that is established makes it clear that \(T\left(2^m\right) = m + 1\text{.}\) This result would seem to indicate that every time you double the size of your list, the search time increases by only one unit.</p>
<p id="p-2762">A more complete solution can be obtained if we represent \(n\) in binary form. For each \(n\geq 1\text{,}\) there exists a non-negative integer \(r\) such that</p>
<div class="displaymath">
\begin{gather}
\quad \quad 2^{r-1}\leq n &lt; 2^r\label{eq-inequality-84}\tag{8.4.3}
\end{gather}
</div>
<p>For example, if \(n = 21\text{,}\) \(2^4 \leq  21 &lt; 2^5\text{;}\) therefore, \(r = 5\text{.}\) If \(n\) satisfies (8.4c), its binary representation requires \(r\) digits. For example, \(21_{\text{ten}}\) = \(10101_{\textrm{two}}\text{.}\)</p>
<p id="p-2763">In general, \(n = \left(a_1a_2\ldots  a_r\right)_{\textrm{two}}\text{.}\) where \(a_1=1\text{.}\) Note that in this form, \(\lfloor n/2\rfloor\) is easy to describe: it is the \(r-1\) digit binary number \(\left(a_1a_2\ldots  a_{r-1}\right)_{\textrm{two}}\)</p>
<p id="p-2764">Therefore,</p>
<div class="displaymath">
\begin{equation*}
\begin{split}
T(n) &amp;= T\left(a_1a_2\ldots  a_r\right)\\
&amp; =1+ T\left(a_1a_2\ldots  a_{r-1}\right)\quad \\
&amp; =1+\left(1+ T\left(a_1a_2\ldots  a_{r-2}\right)\right)\\
&amp; =2+ T\left(a_1a_2\ldots  a_{r-2}\right)\\
&amp;\quad  \vdots \\
&amp; = (r-1) + T\left(a_1\right)\\
&amp; = (r-1)+1\quad \textrm{ since } T(1)=1\\
&amp; = r
\end{split}\text{.}
\end{equation*}
</div>
<p id="p-2765">From the pattern that we've just established, \(T(n)\) reduces to \(r\text{.}\) A formal inductive proof of this statement is possible. However, we expect that most readers would be satisfied with the argument above. Any skeptics are invited to provide the inductive proof.</p>
<p id="p-2766">For those who prefer to see a numeric example, suppose \(n = 21\text{.}\)</p>
<div class="displaymath">
\begin{equation*}
\begin{split}
T(21) &amp;= T(10101) \\
&amp; = 1 + T(1010) \\
&amp;  = 1 + (1 + T(101)) \\
&amp;  = 1 + (1 + (1 + T(10))) \\
&amp;  = 1 + (1 + (1 + (1 + T(1))))\\
&amp;  = 1 + (1 + (1 + (1 + (1 +T(0)))))\\
&amp;  = 5
\end{split}
\end{equation*}
</div>
<p id="p-2767">Our general conclusion is that the solution to <a data-knowl="./knowl/eq-bin-search-recursion.html" title="Equation 8.4.1">(8.4.1)</a>  and <a data-knowl="./knowl/eq-bin-search-basis.html" title="Equation 8.4.2">(8.4.2)</a> is that for \(n\geq 1\text{,}\) \(T(n) = r\text{,}\) where \(2^{r-1}\leq n &lt; 2^r\text{.}\)</p>
<p id="p-2768">A less cumbersome statement of this fact is that \(T(n)=\left\lfloor \log_{2}n\right\rfloor +1\text{.}\) For example, \(T(21) = \left\lfloor \log_2 21\right\rfloor + 1 = 4 + 1 = 5\text{.}\)</p></section><section class="subsubsection" id="sss-review-of-logarithms"><h4 class="heading hide-type">
<span class="type">Subsubsection</span> <span class="codenumber">8.4.2.2</span> <span class="title">Review of Logarithms</span>
</h4>
<a href="s-some-common-rrs.html#sss-review-of-logarithms" class="permalink">¶</a><p id="p-2769">Any discussion of logarithms must start by establishing a base, which can be any positive number other than 1. With the exception of <a data-knowl="./knowl/theorem-logs-related.html" title="Theorem 8.4.5: How logarithms with different bases are related">Theorem 5</a>, our base will be 2. We will see that the use of a different base (10 and \(e\approx  2.171828\) are the other common ones) only has the effect of multiplying each logarithm by a constant. Therefore, the base that you use really isn't very important. Our choice of base 2 logarithms is convenient for the problems that we are considering.</p>
<article class="definition-like" id="def-log-base-2"><h6 class="heading">
<span class="type">Definition</span> <span class="codenumber">8.4.1</span>. <span class="title">Base 2 logarithm.</span>
</h6>
<p id="p-2770">The base 2 logarithm of a positive number represents an exponent and is defined by the following equivalence for any positive real numbers \(a\text{.}\)</p>
<div class="displaymath">
\begin{equation*}
\log_2 a = x \quad \Leftrightarrow \quad 2^x= a\text{.}
\end{equation*}
</div></article><figure class="figure-like" id="fig-log-2-plot"><div style="width: 100%; margin-left: 0%; margin-right: 0%;"><img src="images/fig-log-2-plot.png" style="width: 100%; height: auto;" alt="Plot of the logarithm, bases 2, function"></div>
<figcaption><span class="type">Figure</span> <span class="codenumber">8.4.2.</span> Plot of the logarithm, bases 2, function</figcaption></figure><p id="p-2771">For example, \(\log_2 8 = 3\) because \(2^3 = 8\) and \(\log_21.414\approx 0.5\) because \(2^{0.5}\approx 1.414\text{.}\) A graph of the function \(f(x)
= \log_2 x\) in <a data-knowl="./knowl/fig-log-2-plot.html" title="Figure 8.4.2">Figure 8.4.2</a> shows that if \(a &lt; b\text{,}\) the \(\log_2a &lt; \log_2 b\text{;}\) that is, when \(x\) increases, \(\log_2 x\) also increases. However, if we move \(x\) from \(2^{10} = 1024\) to \(2^{11} = 2048\text{,}\) \(\log_2 x\) only increases from 10 to 11. This slow rate of increase of the logarithm function is an important point to remember. An algorithm acting on \(n\) pieces of data that can be executed in \(\log_2{n}\) time units can handle significantly larger sets of data than an algorithm that can be executed in \(n/100\) or  \(\sqrt{n}\) time units. The graph of \(T(n)=\left\lfloor \log_2n\right\rfloor +1\) would show the same behavior.</p>
<p id="p-2772">A few more properties that we will use in subsequent discussions involving logarithms are summarized in the following theorem.</p>
<article class="theorem-like" id="theorem-log-properties"><h6 class="heading">
<span class="type">Theorem</span> <span class="codenumber">8.4.3</span>. <span class="title">Fundamental Properties of Logarithms.</span>
</h6>
<p id="p-2773">Let \(a\) and \(b\) be positive real numbers, and \(r\) a real number.</p>
<div class="displaymath">
\begin{gather}
\log_2 1 = 0\label{eq-log-prop-1}\tag{8.4.4}\\
\log_2 a b = \log_2a + \log_2b\label{eq-log-prop-2}\tag{8.4.5}\\
\log_2 \frac{a}{b}= \log_2a - \log_2b\label{eq-log-prop-3}\tag{8.4.6}\\
\log_2a^r = r \log_2a\label{eq-log-prop-4}\tag{8.4.7}\\
2^{\log_2a}= a\label{eq-log-prop-5}\tag{8.4.8}
\end{gather}
</div></article><article class="definition-like" id="def-logarithm-general-base"><h6 class="heading">
<span class="type">Definition</span> <span class="codenumber">8.4.4</span>. <span class="title">Logarithms base \(b\).</span>
</h6>
<p id="p-2774">If \(b &gt; 0\text{,}\) \(b \neq 1\text{,}\) then for \(a&gt;0\text{,}\)</p>
<div class="displaymath">
\begin{equation*}
\log_b a = x\Leftrightarrow b^x= a
\end{equation*}
</div></article><article class="theorem-like" id="theorem-logs-related"><h6 class="heading">
<span class="type">Theorem</span> <span class="codenumber">8.4.5</span>. <span class="title">How logarithms with different bases are related.</span>
</h6>
<p id="p-2775">Let \(b&gt;0\text{,}\) \(b \neq 1\text{.}\) Then for all \(a &gt;0\text{,}\) \(\log_b a = \frac{\log_2a}{\log_2b}\text{.}\) Therefore, if \(b &gt; 1\text{,}\) base b logarithms can be computed from base 2 logarithms by dividing by the positive scaling factor \(\log_2b\text{.}\) If \(b &lt; 1\text{,}\) this scaling factor is negative.</p></article><article class="hiddenproof" id="proof-16"><a data-knowl="" class="id-ref" data-refid="hk-proof-16"><h6 class="heading"><span class="type">Proof.</span></h6></a></article><div id="hk-proof-16" class="hidden-content tex2jax_ignore"><article class="hiddenproof"><p id="p-2776">By an analogue of <a data-knowl="./knowl/eq-log-prop-5.html" title="Equation 8.4.8">(8.4.8)</a>, \(a=b^{\log_b a}\text{.}\) Therefore, if we take the base 2 logarithm of both sides of this equality we get:</p>
<div class="displaymath">
\begin{equation*}
\log_2 a = \log_2 \left(b^{\log_b a}\right)  \Rightarrow \log_2 a =\log_b a \cdot \log_2 b
\end{equation*}
</div>
<p>Finally, divide both sides of the last equation by \(\log_2b\text{.}\)</p></article></div>
<article class="remark-like" id="note-5"><h6 class="heading">
<span class="type">Note</span> <span class="codenumber">8.4.6</span>.</h6>
<p id="p-2777">\(\log_{2}10 \approx  3.32192\) and \(\log_{2}e \approx 1.4427\text{.}\)</p></article></section><section class="subsubsection" id="subsubsection-3"><h4 class="heading hide-type">
<span class="type">Subsubsection</span> <span class="codenumber">8.4.2.3</span> <span class="title"></span>
</h4>
<p id="p-2778">Returning to the binary search algorithm, we can derive the final expression for \(T(n)\) using the properties of logarithms, including that the logarithm function is increasing so that inequalities are maintained when taking logarithms of numbers.</p>
<div class="displaymath" id="p-2779">
\begin{equation*}
\begin{split}
T(n)= r &amp; \Leftrightarrow 2^{r-1}\leq n &lt; 2^r\\
&amp; \Leftrightarrow  \log_2 2^{r-1} \leq \log_2 n &lt; \log_2 2^r\\
&amp; \Leftrightarrow  r-1 \leq \log_2 n &lt; r\\
&amp; \Leftrightarrow  r-1 = \lfloor \log_2 n\rfloor \\
&amp; \Leftrightarrow  T(n) = r= \left\lfloor \log_2 n\right\rfloor +1
\end{split}
\end{equation*}
</div>
<p id="p-2780">We can apply several of these properties of logarithms to get an alternate expression for \(T(n)\text{:}\)</p>
<div class="displaymath">
\begin{equation*}
\begin{split}
\left\lfloor \log_2n\right\rfloor +1 &amp;= \left\lfloor \log_2n+1\right\rfloor \\
&amp; = \left\lfloor \log_2n + \log_22\right\rfloor \\
&amp;  =\text{  }\left\lfloor \log_22n \right\rfloor 
\end{split}
\end{equation*}
</div>
<p id="p-2781">If the time that was assigned to Step 1 of the binary search algorithm is changed, we wouldn't expect the form of the solution to be very different. If \(T(n)= a + T (\lfloor n/2 \rfloor )\) with \(T(0) = c\text{,}\) then \(T(n) = c + a \left\lfloor \log_2{2n}\right\rfloor\text{.}\)</p>
<p id="p-2782">A further generalization would be to add a coefficient to \(T(\lfloor n/2 \rfloor )\text{:}\) \(T(n)= a + b T (\lfloor n/2 \rfloor )\) with \(T(0) = c\text{,}\) where \(a, b, c\in \mathbb{R}\text{,}\) and \(b\neq 0\) is not quite as simple to derive. First, if we consider values of \(n\) that are powers of 2:</p>
<div class="displaymath">
\begin{equation*}
\begin{array}{c}
T(1) = a + b T(0) = a + b c\\
T(2)=a + b(a+b c) = a + a b +c b^2\\
T(4)=a+b\left(a + a b +c b^2\right) = a + a b + a b^2+ c b^3\\
\vdots \\
T\left(2^r\right) = a + a b + a b^2+\cdots  + a b^r + c b^{r+1}
\end{array}
\end{equation*}
</div>
<p>If \(n\) is not a power of 2, by reasoning that is identical to what we used to <a data-knowl="./knowl/eq-bin-search-recursion.html" title="Equation 8.4.1">(8.4.1)</a>  and <a data-knowl="./knowl/eq-bin-search-basis.html" title="Equation 8.4.2">(8.4.2)</a>,</p>
<div class="displaymath">
\begin{equation*}
T(n) =\sum_{k=0}^r a b^k+ c b^{r+1}
\end{equation*}
</div>
<p>where \(r = \left\lfloor \log_2n\right\rfloor\text{.}\)</p>
<p id="p-2783">The first term of this expression is a geometric sum, which can be written in closed form. Let \(x\) be that sum:</p>
<div class="displaymath">
\begin{equation*}
\begin{array}{c}
x =a + a b + a b^2+\cdots  + a b^r \\
b x= \textrm{   }a b + a b^2+\cdots  + a b^r + a b^{r+1}
\end{array}
\end{equation*}
</div>
<p>We've multiplied each term of \(x\) by \(b\) and aligned the identical terms in \(x\) and \(bx\text{.}\) Now if we subtract the two equations,</p>
<div class="displaymath">
\begin{equation*}
x - b x = a - a b ^{r+1} \Rightarrow x(1-b) = a\left(1-b^{r+1}\right)
\end{equation*}
</div>
<p>Therefore, \(x = a\frac{b^{r+1}-1}{b-1}\text{.}\)</p>
<p id="p-2784">A closed form expression for \(T(n)\) is</p>
<div class="displaymath">
\begin{equation*}
T(n) = a\frac{b^{r+1}-1}{b-1} +\text{  }c b^{r+1}\text{  }\text{where}\text{  }r = \left\lfloor \log_2n\right\rfloor \text{  }
\end{equation*}
</div></section></section><section class="subsection" id="ss-bubblesort-analysis"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">8.4.3</span> <span class="title">Analysis of Bubble Sort and Merge Sort</span>
</h3>
<a href="s-some-common-rrs.html#ss-bubblesort-analysis" class="permalink">¶</a><p id="p-2785">The efficiency of any search algorithm such as the binary search relies on fact that the search list is sorted according to a key value and that the search is based on the key value. There are several methods for sorting a list. One example is the bubble sort. You might be familiar with this one since it is a popular “first sorting algorithm.” A time analysis of the algorithm shows that if \(B(n)\) is the worst-case time needed to complete the bubble sort on \(n\) items, then \(B(n) =(n-1) + B(n-1)\) and \(B(1) = 0\text{.}\) The solution of this relation is a quadratic function \(B(n) =\frac{1}{2}\left(n^2-n\right)\text{.}\) The growth rate of a quadratic function such as this one is controlled by its squared term. Any other terms are dwarfed by it as \(n\) gets large. For the bubble sort, this means that if we double the size of the list that we are to sort, \(n\) changes to \(2n\) and so \(n^2\) becomes \(4n^2\) . Therefore, the time needed to do a bubble sort is quadrupled. One alternative to bubble sort is the merge sort. Here is a simple version of this algorithm for sorting \(F=\{r(1), r(2), \ldots , r(n)\}\text{,}\) \(n \geq  1\text{.}\) If \(n
= 1\text{,}\) the list is sorted trivially. If \(n\geq  2\) then:</p>
<ol id="p-2786" class="decimal">
<li id="li-1365"><p id="p-2787">Divide \(F\) into \(F_1= \{r(1), \ldots , r(\lfloor n/2\rfloor )\}\) and \(F_2= \{r(\lfloor n/2\rfloor +1), \ldots ,r(n)\}\text{.}\)</p></li>
<li id="li-1366"><p id="p-2788">Sort \(F_1\) and \(F_2\) using a merge sort.</p></li>
<li id="li-1367"><p id="p-2789">Merge the sorted lists \(F_1\) and \(F_2\) into one sorted list. If the sort is to be done in descending order of key values, you continue to choose the higher key value from the fronts of \(F_1\) and \(F_2\) and place them in the back of \(F\text{.}\)</p></li>
</ol>
<p id="p-2790">Note that \(F_1\) will always have \(\lfloor n/2\rfloor\) items and \(F_2\) will have \(\lceil n/2\rceil\) items; thus, if \(n\) is odd, \(F_2\) gets one more item than \(F_1\text{.}\) We will assume that the time required to perform Step 1 of the algorithm is insignificant compared to the other steps; therefore, we will assign a time value of zero to this step. Step 3 requires roughly \(n\) comparisons and \(n\) movements of items from \(F_1\) and \(F_2\) to \(F\text{;}\) thus, its time is proportional to \(n\text{.}\) For this reason, we will assume that Step 3 takes \(n\) time units. Since Step 2 requires \(T(\lfloor n/2\rfloor ) + T(\lceil n/2\rceil )\) time units,</p>
<div class="displaymath">
\begin{gather}
T(n) = n + T(\lfloor n/2\rfloor ) + T(\lceil n/2\rceil )\label{eq-bubble-r}\tag{8.4.9}
\end{gather}
</div>
<p>with the initial condition</p>
<div class="displaymath">
\begin{gather}
T(1) = 0\label{eq-bubble-b}\tag{8.4.10}
\end{gather}
</div>
<p id="p-2791">Instead of an exact solution of these equations, we will be content with an estimate for \(T(n)\text{.}\)  First, consider the case of \(n=2^r\text{,}\) \(r \geq 1\text{:}\)</p>
<div class="displaymath">
\begin{equation*}
\begin{array}{c}
T\left(2^1\right)= T(2) = 2 +T(1)+T(1)= 2 = 1\cdot  2\\
T\left(2^2\right) = T(4)=4+\text{  }T(2)+T(2)=8 = 2\cdot 4\\
T\left(2^3\right) =T(8)=8 + T(4)+T(4) =24=3\cdot 8\\
\vdots \\
T\left(2^r\right)=r 2^r= 2^r \log_2 2^r
\end{array}
\end{equation*}
</div>
<p id="p-2792">Thus, if \(n\) is a power of 2, \(T(n) = n \log_2 n\text{.}\) Now if, for some \(r \geq  2\text{,}\) \(2^{r-1}\leq n\leq 2^r\text{,}\) then \((r-1)2^{r-1}\leq
T(n) &lt; r 2^r\text{.}\) This can be proved by induction on \(r\text{.}\) As \(n\) increases from \(2^{r-1}\) to \(2^r\text{,}\) \(T(n)\) increases from \((r-1)2^{r-1}\)to \(r 2^r\) and is slightly larger than \(\left\lfloor n \log_2n\right\rfloor\text{.}\) The discrepancy is small enough so that \(T_e(n)=\left\lfloor n \log
_2n\right\rfloor\) can be considered a solution of <a data-knowl="./knowl/eq-bubble-r.html" title="Equation 8.4.9">(8.4.9)</a> and <a data-knowl="./knowl/eq-bubble-b.html" title="Equation 8.4.10">(8.4.10)</a> for the purposes of comparing the merge sort with other algorithms. <a data-knowl="./knowl/table-sort-analysis.html" title="Table 8.4.7">Table 8.4.7</a> compares \(B(n)\) with \(T_e(n)\) for selected values of \(n\text{.}\)</p>
<figure class="figure-like" id="table-sort-analysis"><table>
<tr>
<td class="c m b0 r0 l0 t3 lines">n</td>
<td class="c m b0 r0 l0 t3 lines">\(B(n)\)</td>
<td class="c m b0 r0 l0 t3 lines">\(T_e(n)\)</td>
</tr>
<tr>
<td class="c m b0 r0 l0 t0 lines">10</td>
<td class="c m b0 r0 l0 t0 lines">45</td>
<td class="c m b0 r0 l0 t0 lines">34</td>
</tr>
<tr>
<td class="c m b0 r0 l0 t0 lines">50</td>
<td class="c m b0 r0 l0 t0 lines">1225</td>
<td class="c m b0 r0 l0 t0 lines">283</td>
</tr>
<tr>
<td class="c m b0 r0 l0 t0 lines">100</td>
<td class="c m b0 r0 l0 t0 lines">4950</td>
<td class="c m b0 r0 l0 t0 lines">665</td>
</tr>
<tr>
<td class="c m b0 r0 l0 t0 lines">500</td>
<td class="c m b0 r0 l0 t0 lines">124750</td>
<td class="c m b0 r0 l0 t0 lines">4483</td>
</tr>
<tr>
<td class="c m b0 r0 l0 t0 lines">1000</td>
<td class="c m b0 r0 l0 t0 lines">499500</td>
<td class="c m b0 r0 l0 t0 lines">9966</td>
</tr>
</table>
<figcaption><span class="type">Table</span> <span class="codenumber">8.4.7.</span> Comparison of Times for Bubble Sort and Merge Sort</figcaption></figure></section><section class="subsection" id="ss-derangements"><h3 class="heading hide-type">
<span class="type">Subsection</span> <span class="codenumber">8.4.4</span> <span class="title">Derangements</span>
</h3>
<a href="s-some-common-rrs.html#ss-derangements" class="permalink">¶</a><p id="p-2793">A derangement is a permutation on a set that has no “fixed points”.  Here is a formal definition:</p>
<article class="definition-like" id="def-derangement"><h6 class="heading">
<span class="type">Definition</span> <span class="codenumber">8.4.8</span>. <span class="title">Derangement.</span>
</h6>
<p id="p-2794">A derangement of a nonempty set \(A\) is a permutation of \(A\) (i.e., a bijection from \(A\) into \(A\)) such that \(f(a)\neq a\) for all \(a \in  A\text{.}\)</p></article><p id="p-2795">If \(A = \{1, 2, . . . , n\}\text{,}\) an interesting question might be “How many derangements are there of \(A\text{?}\)”  We know that our answer is bounded above by \(n!\text{.}\) We can also expect our answer to be quite a bit smaller than \(n!\) since \(n\) is the image of itself for \((n-1)!\) of the permutations of \(A\text{.}\)</p>
<p id="p-2796">Let \(D(n)\) be the number of derangements of \(\{1, 2, . . . , n\}\text{.}\) Our answer will come from discovering a recurrence relation on \(D\text{.}\) Suppose that \(n \geq  3\text{.}\) If we are to construct a derangement of \(\{1, 2, \dots , n\}\text{,}\) \(f\text{,}\) then \(f(n) = k \neq n\text{.}\) Thus, the image of \(n\) can be selected in \(n-1\) different ways. No matter which of the \(n -1\) choices we make, we can complete the definition of \(f\) in one of two ways. First, we can decide to make \(f(k) = n\text{,}\) leaving \(D(n -2)\) ways of completing the definition of \(f\text{,}\) since \(f\) will be a derangement of \(\{1, 2, \dots ,n\} - \{n, k\}\text{.}\) Second, if we decide to select \(f(k)\neq  n\text{,}\) each of the \(D(n - 1)\) derangements of \(\{1, 2,\dots ,n-1\}\) can be used to define \(f\text{.}\) If \(g\) is a derangement of \(\{1, 2, \dots , n-1\}\) such that \(g(p) = k\text{,}\) then define f by</p>
<div class="displaymath">
\begin{equation*}
f(j)=\left\{
\begin{array}{cc}
n &amp; \textrm{ if } j = p \\
k &amp; \textrm{ if } j = n \\
g(j) &amp; \textrm{ otherwise } \\
\end{array}
\right.
\end{equation*}
</div>
<p id="p-2797">Note that with our second construction of \(f\text{,}\) \(f(f(n)) = f(k) \neq  n\text{,}\) while in the first construction, \(f(f(n)) = f(k) = n\text{.}\) Therefore, no derangement of \(\{1, 2, . . . , n\}\) with \(f(n) = k\) can be constructed by both methods.</p>
<p id="p-2798">To recap our result, we see that \(f\) is determined by first choosing one of \(n - 1\) images of \(n\) and then constructing the remainder of \(f\) in one of \(D(n - 2) + D(n -1)\) ways. Therefore,</p>
<div class="displaymath">
\begin{gather}
D(n) = (n - 1) (D(n - 2) + D(n - 1))\tag{8.4.11}
\end{gather}
</div>
<p id="p-2799">This homogeneous second-order linear relation with variable coefficients, together with the initial conditions \(D(1) = 0\) and \(D(2) = 1\text{,}\) completely defines \(D\text{.}\) Instead of deriving a solution of this relation by analytical methods, we will give an empirical derivation of an approximation of \(D(n)\text{.}\) Since the derangements of \(\{1,2 . . . , n\}\) are drawn from a pool of \(n!\) permutations, we will see what percentage of these permutations are derangements by listing the values of \(n!\text{,}\) \(D(n)\text{,}\) and \(\frac{D(n)}{n!}\text{.}\)  The results we observe will indicate that as \(n\) grows, \(\frac{D(n)}{n!}\) hardly changes at all. If this quotient is computed to eight decimal places, for \(n \geq  12\text{,}\) \(D(n)/n!
= 0.36787944\text{.}\) The reciprocal of this number, which \(D(n)/n!\) seems to be tending toward, is, to eight places, 2.7182818. This number appears in so many places in mathematics that it has its own name, \(e\text{.}\) An approximate solution of our recurrence relation on \(D\) is then \(D(n)\approx \frac{n!}{e}\text{.}\)</p>
<div class="sagecell-sage" id="sage-17"><script type="text/x-sage">def D(n):
	if n<=2:
		return n-1
	else:
		return (n-1)*(D(n-2)+D(n-1))

map(lambda k:[k,D(k),(D(k)/factorial(k)).n(digits=8)],range(1,16))
</script></div></section><section class="exercises" id="exercises-8-4"><h3 class="heading hide-type">
<span class="type">Exercises</span> <span class="codenumber">8.4.5</span> <span class="title">Exercises for Section 8.4</span>
</h3>
<a href="s-some-common-rrs.html#exercises-8-4" class="permalink">¶</a><article class="exercise-like" id="exercise-336"><h6 class="heading"><span class="codenumber">1.</span></h6>
<p id="p-2800">Solve the following recurrence relations. Indicate whether your solution is an improvement over iteration.</p>
<ol id="p-2801" class="lower-alpha">
<li id="li-1368"><p id="p-2802">\(n S(n) - S(n - 1) = 0\text{,}\) \(S(0) = 1\text{.}\)</p></li>
<li id="li-1369"><p id="p-2803">\(T(k) + 3k T(k - 1) = 0\text{,}\) \(T(0) = 1\text{.}\)</p></li>
<li id="li-1370"><p id="p-2804">\(U(k) -\frac{k-1}{k}U(k - 1) = 0\text{,}\) \(k \geq  2\text{,}\) \(U(1) = 1\text{.}\)</p></li>
</ol>
<div class="solutions">
<a data-knowl="" class="id-ref" data-refid="hk-answer-159" id="answer-159"><span class="type">Answer</span></a><div id="hk-answer-159" class="hidden-content tex2jax_ignore"><div class="solution"><ol id="p-2805" class="lower-alpha">
<li id="li-1371"><p id="p-2806">\(S(n)=1/n\text{!}\)</p></li>
<li id="li-1372"><p id="p-2807">\(U(k)=1/k\text{,}\) an improvement.</p></li>
<li id="li-1373"><p id="p-2808">\(T(k)=(-3)^kk\text{!,}\) no improvement.</p></li>
</ol></div></div>
</div></article><article class="exercise-like" id="exercise-337"><h6 class="heading"><span class="codenumber">2.</span></h6>
<p id="p-2809">Prove that if \(n \geq 0\text{,}\) \(\lfloor n/2\rfloor +\lceil n/2\rceil = n\text{.}\) (Hint: Consider the cases of \(n\) odd and \(n\) even separately.)</p></article><article class="exercise-like" id="exercise-338"><h6 class="heading"><span class="codenumber">3.</span></h6>
<p id="p-2810">Solve as completely as possible:</p>
<ol id="p-2811" class="lower-alpha">
<li id="li-1374"><p id="p-2812">\(T(n) = 3 + T(\lfloor n/2\rfloor )\text{,}\) \(T(0) = 0\text{.}\)</p></li>
<li id="li-1375"><p id="p-2813">\(T(n) = 1 + \frac{1}{2}T(\lfloor n/2\rfloor )\text{,}\) \(T(0) = 2\text{.}\)</p></li>
<li id="li-1376"><p id="p-2814">\(V(n) = 1 + V\lfloor n/8\rfloor )\text{,}\) \(V(0) = 0\text{.}\) (Hint: Write \(n\) in octal form.)</p></li>
</ol>
<div class="solutions">
<a data-knowl="" class="id-ref" data-refid="hk-answer-160" id="answer-160"><span class="type">Answer</span></a><div id="hk-answer-160" class="hidden-content tex2jax_ignore"><div class="solution"><ol id="p-2815" class="lower-alpha">
<li id="li-1377"><p id="p-2816">\(T(n)=3\left(\left\lfloor \log_2n\right\rfloor +1\right)\)</p></li>
<li id="li-1378"><p id="p-2817">\(T(n)=2\)</p></li>
<li id="li-1379"><p id="p-2818">\(V(n)=\left\lfloor \log_8n\right\rfloor +1\)</p></li>
</ol></div></div>
</div></article><article class="exercise-like" id="exercise-339"><h6 class="heading"><span class="codenumber">4.</span></h6>
<p id="p-2819">Prove by induction that if \(T(n)= 1 + T (\lfloor n/2 \rfloor )\text{,}\) \(T(0) = 0\text{,}\) and \(2^{r-1}\leq n &lt; 2^r\) , \(r \geq  1\text{,}\) then \(T(n) = r\text{.}\)</p>
<div class="solutions">
<a data-knowl="" class="id-ref" data-refid="hk-hint-12" id="hint-12"><span class="type">Hint</span></a><div id="hk-hint-12" class="hidden-content tex2jax_ignore"><div class="solution"><p id="p-2820">Prove by induction on \(r\text{.}\)</p></div></div>
</div></article><article class="exercise-like" id="exercise-340"><h6 class="heading"><span class="codenumber">5.</span></h6>
<p id="p-2821">Use the substitution \(S(n) = T(n+1)/T(n)\)  to solve \(T(n)T(n-2)=T(n-1)^2\) for \(n \geq  2\text{,}\) with \(T(0) = 1\text{,}\) \(T(1) = 6\text{,}\) and \(T(n) \geq  0\text{.}\)</p>
<div class="solutions">
<a data-knowl="" class="id-ref" data-refid="hk-answer-161" id="answer-161"><span class="type">Answer</span></a><div id="hk-answer-161" class="hidden-content tex2jax_ignore"><div class="solution"><p id="p-2822">The indicated substitution yields \(S(n)=S(n+1)\text{.}\) Since \(S(0)=T(1)/T(0)=6\text{,}\) \(S(n)=6\) for all \(n\text{.}\) Therefore \(T(n+1)=6T(n)\Rightarrow T(n)=6^n\text{.}\)</p></div></div>
</div></article><article class="exercise-like" id="exercise-341"><h6 class="heading"><span class="codenumber">6.</span></h6>
<p id="p-2823">Use the substitution \(G(n) =T(n)^2\) to solve \(T(n)^2-T(n-1)^2=1\) for \(n \geq  1\text{,}\) with \(T(0) = 10\text{.}\)</p></article><article class="exercise-like" id="exercise-342"><h6 class="heading"><span class="codenumber">7.</span></h6>
<p id="p-2824">Solve as completely as possible:</p>
<ol id="p-2825" class="lower-alpha">
<li id="li-1380"><p id="p-2826">\(Q(n)=1+Q\left(\left\lfloor \sqrt{n}\right\rfloor \right)\text{,}\) \(n \geq  2\text{,}\) \(Q(1) = 0\text{.}\)</p></li>
<li id="li-1381"><p id="p-2827">\(R(n)=n +R(\lfloor n/2\rfloor )\text{,}\) \(n \geq  1\text{,}\) \(R(0) = 0\text{.}\)</p></li>
</ol>
<div class="solutions">
<a data-knowl="" class="id-ref" data-refid="hk-answer-162" id="answer-162"><span class="type">Answer</span></a><div id="hk-answer-162" class="hidden-content tex2jax_ignore"><div class="solution"><ol id="p-2828" class="lower-alpha">
<li id="li-1382"><p id="p-2829">A good approximation to the solution of this recurrence relation is based on the following observation: \(n\) is a power of a power of two; that is, \(n\) is \(2^m\text{,}\) where \(m=2^k\) , then \(Q(n)=1+Q\left(2^{m/2}\right)\text{.}\) By applying this recurrence relation \(k\) times we obtain \(Q(n)=k\text{.}\) Going back to the original form of \(n\text{,}\) \(\log _2n=2^k\) or \(\log _2\left(\log _2n\right)=k\text{.}\) We would expect that in general, \(Q(n)\) is \(\left\lfloor \log _2\left(\log _2n\right)\right\rfloor\text{.}\) We do not see any elementary method for arriving at an exact solution.</p></li>
<li id="li-1383"><p id="p-2830">Suppose that \(n\) is a positive integer with \(2^{k-1} \leq n &lt; 2^k\text{.}\) Then \(n\) can be written in binary form, \(\left(a_{k-1}a_{k-2}\cdots  a_2a_1a_0\right)_{\textrm{two}}\) with \(a_{k-1}=1\) and \(R(n)\) is equal to the sum \(\underset{i=0}{\overset{k-1}{\Sigma }}\) \(\left(a_{k-1}a_{k-2}\cdots  a_i\right)_{\textrm{two}}\text{.}\) If \(2^{k-1}\leq n &lt; 2^k\text{,}\) then we can estimate this sum to be between \(2n-1\) and \(2n+1\text{.}\) Therefore, \(R(n)\approx 2n\text{.}\)</p></li>
</ol></div></div>
</div></article><article class="exercise-like" id="exercise-343"><h6 class="heading"><span class="codenumber">8.</span></h6>
<p id="p-2831">Suppose Step 1 of the merge sort algorithm did take a significant amount of time. Assume it takes 0.1 time unit, independent of the value of \(n\text{.}\)</p>
<ol id="p-2832" class="lower-alpha">
<li id="li-1384"><p id="p-2833">Write out a new recurrence relation for \(T(n)\) that takes this factor into account.</p></li>
<li id="li-1385"><p id="p-2834">Solve for \(T\left(2^r\right)\text{,}\) \(r \geq  0\text{.}\)</p></li>
<li id="li-1386"><p id="p-2835">Assuming the solution for powers of 2 is a good estimate for all \(n\text{,}\) compare your result to the solution in the text. As gets large, is there really much difference?</p></li>
</ol></article></section></section></div></main>
</div>
<!--Start: StatCounter code--><script>
var sc_project=11204831;
var sc_invisible=1;
var sc_security="957c565b";
var scJsHost = (("https:" == document.location.protocol) ? "https://secure." : "https://www.");
document.write("<sc"+"ript src='" + scJsHost+ "statcounter.com/counter/counter.js'></"+"script>");
</script><noscript><div class="statcounter"><a title="web analytics" href="https://statcounter.com/" target="_blank"><img class="statcounter" src="https://c.statcounter.com/11204831/0/957c565b/1/" alt="web analytics"></a></div></noscript>
<!--End: StatCounter code-->
<div class="login-link"><span id="loginlogout" class="login">login</span></div>
<script src="https://pretextbook.org/js/0.11/login.js"></script>
</body>
</html>
